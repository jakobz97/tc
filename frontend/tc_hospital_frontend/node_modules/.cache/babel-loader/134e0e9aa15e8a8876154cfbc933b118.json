{"ast":null,"code":"import _slicedToArray from\"/Users/Jakob/Desktop/TUM/Semester_01/inno_entre/tech_challenge/tc/frontend/tc_hospital_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{history}from\"../../../helpers/history\";import{selectIsLoggedIn,selectUserType}from\"../../../slice/authSlice\";import{selectUserData,getUserAsync}from\"../../../slice/userSlice\";import{getReviewAnalyticsAsync}from\"../../../slice/reviewSlice\";import'../../../styles/shared/main.css';import'../../../styles/shared/analytics/analytics.css';import Navbar from\"../../general/navbar/Navbar\";import AnalyticsListItem from\"../../student/analytics/AnalyticsListItem\";import DetailedAnalytics from\"../../student/analytics/DetailedAnalytics\";import GeneralAnalytics from\"../../student/analytics/GeneralAnalytics\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Analytics=function Analytics(){var dispatch=useDispatch();var loggedIn=useSelector(selectIsLoggedIn);var userType=useSelector(selectUserType);var userData=useSelector(selectUserData);if(!loggedIn||userType!=='student'){history.push(\"/login\");window.location.reload();}var _useState=useState([]),_useState2=_slicedToArray(_useState,2),reviewDataList=_useState2[0],setReviewDataList=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),globalAnalytics=_useState4[0],setGlobalAnalytics=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),visibleDetailedAnalytics=_useState6[0],setVisibleDetailedAnalytics=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),detailedAnalyticsData=_useState8[0],setDetailedAnalyticsData=_useState8[1];/**\n     * @function (00) if user data has been loaded check if any reviews were already made - if true load the reviewed uploads\n     *           (01) load answered uploads for this user - if user has ´made any reviews so far\n     *           (02) hide the loading sign once fulfilled\n     */useEffect(function(){//00\nif(Object.keys(userData).length>0){getAnalytics(userData.answeredUploads);return;}//01\ndispatch(getUserAsync()).then(function(res){getAnalytics(res.payload.userData.answeredUploads);}).catch(function(err){console.log('err',err);});},[]);// Detailed view ==============================\n/**\n     * @function (01) update the state and fade in the\n     * @param data\n     */var detailedView=function detailedView(data){setDetailedAnalyticsData(data);setVisibleDetailedAnalytics(true);};// Helper functions ===========================\n/**\n     * @function (01) check if user has made any revies so far\n     *           (02) load the reviews from the backend\n     *           (03) assign the results to the local variables\n     * @param reviewIds array of reviews [0] reviewId [1] reviewAnswerId [2] reviewAnswerSubId\n     */var getAnalytics=function getAnalytics(reviewIds){//01\nif(!reviewIds||reviewIds.length===0)console.log('No replies so far');//02\ndispatch(getReviewAnalyticsAsync(reviewIds)).then(function(res){setGlobalAnalytics(res.payload.globalKPIS);setReviewDataList(res.payload.reviewData);}).catch(function(err){console.log('error',err);});};return/*#__PURE__*/_jsxs(\"div\",{className:\"center_container\",children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"main_center_content_wrapper\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"main_outer_content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main_outer_heading\",children:\"Analytics\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"main_center_content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"analytics_review_wrapper\",children:reviewDataList.length>0?reviewDataList.map(function(elem,index){return/*#__PURE__*/_jsx(AnalyticsListItem,{data:elem,index:index,detailedView:detailedView});}):/*#__PURE__*/_jsx(\"div\",{className:\"no_analytics_txt\",children:\"Tackle reviews - No answers mean no analytics\"})}),reviewDataList.length>0&&/*#__PURE__*/_jsx(GeneralAnalytics,{data:globalAnalytics}),visibleDetailedAnalytics&&/*#__PURE__*/_jsx(DetailedAnalytics,{data:detailedAnalyticsData,close:function close(){return setVisibleDetailedAnalytics(false);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"main_outer_content right_bound_outer_content\"})]})]});};export default Analytics;","map":{"version":3,"sources":["/Users/Jakob/Desktop/TUM/Semester_01/inno_entre/tech_challenge/tc/frontend/tc_hospital_frontend/src/components/student/analytics/Analytics.js"],"names":["React","useState","useEffect","useDispatch","useSelector","history","selectIsLoggedIn","selectUserType","selectUserData","getUserAsync","getReviewAnalyticsAsync","Navbar","AnalyticsListItem","DetailedAnalytics","GeneralAnalytics","Analytics","dispatch","loggedIn","userType","userData","push","window","location","reload","reviewDataList","setReviewDataList","globalAnalytics","setGlobalAnalytics","visibleDetailedAnalytics","setVisibleDetailedAnalytics","detailedAnalyticsData","setDetailedAnalyticsData","Object","keys","length","getAnalytics","answeredUploads","then","res","payload","catch","err","console","log","detailedView","data","reviewIds","globalKPIS","reviewData","map","elem","index"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from \"react\";\n\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {history} from \"../../../helpers/history\";\n\nimport {selectIsLoggedIn, selectUserType} from \"../../../slice/authSlice\";\nimport {selectUserData, getUserAsync} from \"../../../slice/userSlice\";\nimport {getReviewAnalyticsAsync} from \"../../../slice/reviewSlice\";\n\nimport '../../../styles/shared/main.css';\nimport '../../../styles/shared/analytics/analytics.css';\n\nimport Navbar from \"../../general/navbar/Navbar\";\nimport AnalyticsListItem from \"../../student/analytics/AnalyticsListItem\";\nimport DetailedAnalytics from \"../../student/analytics/DetailedAnalytics\";\nimport GeneralAnalytics from \"../../student/analytics/GeneralAnalytics\";\n\nconst Analytics = () => {\n\n    const dispatch = useDispatch();\n\n    const loggedIn = useSelector(selectIsLoggedIn);\n    const userType = useSelector(selectUserType);\n    const userData = useSelector(selectUserData);\n\n    if (!loggedIn || userType !== 'student') {\n        history.push(\"/login\");\n        window.location.reload();\n    }\n\n    const [reviewDataList, setReviewDataList] = useState([])\n    const [globalAnalytics, setGlobalAnalytics] = useState({})\n    const [visibleDetailedAnalytics, setVisibleDetailedAnalytics] = useState(false)\n    const [detailedAnalyticsData, setDetailedAnalyticsData] = useState({})\n\n    /**\n     * @function (00) if user data has been loaded check if any reviews were already made - if true load the reviewed uploads\n     *           (01) load answered uploads for this user - if user has ´made any reviews so far\n     *           (02) hide the loading sign once fulfilled\n     */\n    useEffect(() => {\n        //00\n        if (Object.keys(userData).length > 0) {\n            getAnalytics(userData.answeredUploads);\n            return;\n        }\n        //01\n        dispatch(getUserAsync())\n            .then((res) => {\n                getAnalytics(res.payload.userData.answeredUploads)\n            })\n            .catch((err) => {\n                console.log('err', err)\n            })\n    }, [])\n\n    // Detailed view ==============================\n\n    /**\n     * @function (01) update the state and fade in the\n     * @param data\n     */\n    const detailedView = (data) => {\n        setDetailedAnalyticsData(data)\n        setVisibleDetailedAnalytics(true)\n\n    }\n\n    // Helper functions ===========================\n\n    /**\n     * @function (01) check if user has made any revies so far\n     *           (02) load the reviews from the backend\n     *           (03) assign the results to the local variables\n     * @param reviewIds array of reviews [0] reviewId [1] reviewAnswerId [2] reviewAnswerSubId\n     */\n    const getAnalytics = (reviewIds) => {\n        //01\n        if (!reviewIds || reviewIds.length === 0)  console.log('No replies so far')\n        //02\n        dispatch(getReviewAnalyticsAsync(reviewIds))\n            .then((res) => {\n                setGlobalAnalytics(res.payload.globalKPIS)\n                setReviewDataList(res.payload.reviewData)\n            })\n            .catch((err) => {\n                console.log('error', err)\n            })\n    }\n\n    return (\n        <div className=\"center_container\">\n            <Navbar />\n            <div className=\"main_center_content_wrapper\">\n                <div className=\"main_outer_content\">\n                    <div className=\"main_outer_heading\">Analytics</div>\n                </div>\n\n                <div className=\"main_center_content\">\n                    <div className=\"analytics_review_wrapper\">\n                    {\n                        reviewDataList.length > 0 ? (\n                            reviewDataList.map((elem, index) => <AnalyticsListItem data = {elem} index = {index} detailedView = {detailedView} />)\n                        ) : (\n                            <div className=\"no_analytics_txt\">Tackle reviews - No answers mean no analytics</div>\n                        )\n                    }\n                    </div>\n                    { reviewDataList.length > 0 && <GeneralAnalytics data = {globalAnalytics} />}\n                    { visibleDetailedAnalytics && <DetailedAnalytics data = {detailedAnalyticsData}  close = {() => setVisibleDetailedAnalytics(false)}/> }\n                </div>\n\n                <div className=\"main_outer_content right_bound_outer_content\"></div>\n            </div>\n        </div>\n    );\n};\n\nexport default Analytics;\n"]},"metadata":{},"sourceType":"module"}